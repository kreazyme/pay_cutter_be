{"version":3,"sources":["../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from 'express';\r\nimport { Container } from 'typedi';\r\nimport { RequestWithUser } from '@interfaces/auth.interface';\r\nimport { User } from '@interfaces/users.interface';\r\nimport { AuthService } from '@services/auth.service';\r\n\r\nexport class AuthController {\r\n  public auth = Container.get(AuthService);\r\n\r\n  public signUp = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData: User = req.body;\r\n      const signUpUserData: User = await this.auth.signup(userData);\r\n\r\n      res.status(201).json({ data: signUpUserData, message: 'signup' });\r\n    } catch (error) {\r\n      next(error);\r\n    }\r\n  };\r\n\r\n  public logIn = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData: User = req.body;\r\n      const { cookie, findUser, token } = await this.auth.login(userData);\r\n\r\n      res.setHeader('Set-Cookie', [cookie]);\r\n      res.status(200).json({ data: findUser, message: 'login' , token: token});\r\n    } catch (error) {\r\n      next(error);\r\n    }\r\n  };\r\n\r\n  public logOut = async (req: RequestWithUser, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData: User = req.user;\r\n      const logOutUserData: User = await this.auth.logout(userData);\r\n\r\n      res.setHeader('Set-Cookie', ['Authorization=; Max-age=0']);\r\n      res.status(200).json({ data: logOutUserData, message: 'logout' });\r\n    } catch (error) {\r\n      next(error);\r\n    }\r\n  };\r\n}\r\n"],"names":["AuthController","auth","Container","get","AuthService","signUp","req","res","next","userData","body","signUpUserData","signup","status","json","data","message","error","logIn","cookie","findUser","token","login","setHeader","logOut","user","logOutUserData","logout"],"mappings":";;;;+BAMaA;;aAAAA;;wBALa;6BAGE;;;;;;;;;;;;;;AAErB,IAAA,AAAMA,iBAAN,MAAMA;;QACX,uBAAOC,QAAOC,iBAAS,CAACC,GAAG,CAACC,wBAAW;QAEvC,uBAAOC,UAAS,OAAOC,KAAcC,KAAeC,OAAsC;YACxF,IAAI;gBACF,MAAMC,WAAiBH,IAAII,IAAI;gBAC/B,MAAMC,iBAAuB,MAAM,IAAI,CAACV,IAAI,CAACW,MAAM,CAACH;gBAEpDF,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMJ;oBAAgBK,SAAS;gBAAS;YACjE,EAAE,OAAOC,OAAO;gBACdT,KAAKS;YACP;QACF;QAEA,uBAAOC,SAAQ,OAAOZ,KAAcC,KAAeC,OAAsC;YACvF,IAAI;gBACF,MAAMC,WAAiBH,IAAII,IAAI;gBAC/B,MAAM,EAAES,OAAM,EAAEC,SAAQ,EAAEC,MAAK,EAAE,GAAG,MAAM,IAAI,CAACpB,IAAI,CAACqB,KAAK,CAACb;gBAE1DF,IAAIgB,SAAS,CAAC,cAAc;oBAACJ;iBAAO;gBACpCZ,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMK;oBAAUJ,SAAS;oBAAUK,OAAOA;gBAAK;YACxE,EAAE,OAAOJ,OAAO;gBACdT,KAAKS;YACP;QACF;QAEA,uBAAOO,UAAS,OAAOlB,KAAsBC,KAAeC,OAAsC;YAChG,IAAI;gBACF,MAAMC,WAAiBH,IAAImB,IAAI;gBAC/B,MAAMC,iBAAuB,MAAM,IAAI,CAACzB,IAAI,CAAC0B,MAAM,CAAClB;gBAEpDF,IAAIgB,SAAS,CAAC,cAAc;oBAAC;iBAA4B;gBACzDhB,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMW;oBAAgBV,SAAS;gBAAS;YACjE,EAAE,OAAOC,OAAO;gBACdT,KAAKS;YACP;QACF;;AACF"}